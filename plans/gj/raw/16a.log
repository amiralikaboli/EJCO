
TreeOp { name: "HASH_JOIN", timing: 0.001118, cardinality: 25, extra_info: "INNER\nmc.company_id = cn.id\n", children: [TreeOp { name: "HASH_JOIN", timing: 2.3e-5, cardinality: 54, extra_info: "INNER\nmk.keyword_id = k.id\n", children: [TreeOp { name: "HASH_JOIN", timing: 0.017806, cardinality: 4234, extra_info: "INNER\nt.id = mc.movie_id\nmk.movie_id = mc.movie_id\n", children: [TreeOp { name: "HASH_JOIN", timing: 0.016656, cardinality: 15655, extra_info: "INNER\nmk.movie_id = t.id\n", children: [TreeOp { name: "SEQ_SCAN", timing: 0.000855, cardinality: 4523930, extra_info: "movie_keyword\n[INFOSEPARATOR]\nmovie_id\nkeyword_id", children: [], attr: Some(Scan(ScanAttr { table_name: "movie_keyword", attributes: [movie_keyword.movie_id, movie_keyword.keyword_id] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.023682, cardinality: 68245, extra_info: "title\n[INFOSEPARATOR]\nepisode_nr\nid\ntitle\n[INFOSEPARATOR]\nFilters: episode_nr>=50 AND episode_nr<100 AND episode_nr IS NOT NULL\n", children: [], attr: Some(Scan(ScanAttr { table_name: "title", attributes: [title.episode_nr, title.id, title.title] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: mk.movie_id, right_attr: t.id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.000421, cardinality: 2609129, extra_info: "movie_companies\n[INFOSEPARATOR]\nmovie_id\ncompany_id", children: [], attr: Some(Scan(ScanAttr { table_name: "movie_companies", attributes: [movie_companies.movie_id, movie_companies.company_id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: t.id, right_attr: mc.movie_id }, Equalizer { left_attr: mk.movie_id, right_attr: mc.movie_id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.001342, cardinality: 1, extra_info: "keyword\n[INFOSEPARATOR]\nkeyword\nid\n[INFOSEPARATOR]\nFilters: keyword=character-name-in-title AND keyword IS NOT NULL\n", children: [], attr: Some(Scan(ScanAttr { table_name: "keyword", attributes: [keyword.keyword, keyword.id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: mk.keyword_id, right_attr: k.id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.002228, cardinality: 84843, extra_info: "company_name\n[INFOSEPARATOR]\ncountry_code\nid\n[INFOSEPARATOR]\nFilters: country_code=[us] AND country_code IS NOT NULL\n", children: [], attr: Some(Scan(ScanAttr { table_name: "company_name", attributes: [company_name.country_code, company_name.id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: mc.company_id, right_attr: cn.id }] })) }
[(Name("mk"), [Name("movie_id"), Name("keyword_id")], []), (Name("t"), [Name("id")], [Name("title")]), (Name("mc"), [Name("movie_id"), Name("company_id")], []), (Name("k"), [Name("id")], []), (Name("cn"), [Name("id")], [])]
[Lookup([0 @ mk.movie_id = 0 @ t.id), 0 @ mk.movie_id = 1 @ mc.movie_id), 1 @ mk.keyword_id = 2 @ k.id)]), Intersect([mc.company_id @ 1), cn.id @ 3)])]

TreeOp { name: "HASH_JOIN", timing: 0.020498, cardinality: 385, extra_info: "INNER\nn.id = an.person_id\nci.person_id = an.person_id\n", children: [TreeOp { name: "HASH_JOIN", timing: 0.122552, cardinality: 323, extra_info: "INNER\nci.movie_id = t.id\nci.movie_id = mk.movie_id\nci.movie_id = mc.movie_id\n", children: [TreeOp { name: "HASH_JOIN", timing: 0.314216, cardinality: 36244344, extra_info: "INNER\nci.person_id = n.id\n", children: [TreeOp { name: "SEQ_SCAN", timing: 0.012257, cardinality: 36244344, extra_info: "cast_info\n[INFOSEPARATOR]\nperson_id\nmovie_id", children: [], attr: Some(Scan(ScanAttr { table_name: "cast_info", attributes: [cast_info.person_id, cast_info.movie_id] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.00062, cardinality: 4167491, extra_info: "name\n[INFOSEPARATOR]\nid", children: [], attr: Some(Scan(ScanAttr { table_name: "name", attributes: [name.id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: ci.person_id, right_attr: n.id }] })) }, TreeOp { name: "HASH_JOIN", timing: 0.001118, cardinality: 25, extra_info: "INNER\nmc.company_id = cn.id\n", children: [TreeOp { name: "HASH_JOIN", timing: 2.3e-5, cardinality: 54, extra_info: "INNER\nmk.keyword_id = k.id\n", children: [TreeOp { name: "HASH_JOIN", timing: 0.017806, cardinality: 4234, extra_info: "INNER\nt.id = mc.movie_id\nmk.movie_id = mc.movie_id\n", children: [TreeOp { name: "HASH_JOIN", timing: 0.016656, cardinality: 15655, extra_info: "INNER\nmk.movie_id = t.id\n", children: [TreeOp { name: "SEQ_SCAN", timing: 0.000855, cardinality: 4523930, extra_info: "movie_keyword\n[INFOSEPARATOR]\nmovie_id\nkeyword_id", children: [], attr: Some(Scan(ScanAttr { table_name: "movie_keyword", attributes: [movie_keyword.movie_id, movie_keyword.keyword_id] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.023682, cardinality: 68245, extra_info: "title\n[INFOSEPARATOR]\nepisode_nr\nid\ntitle\n[INFOSEPARATOR]\nFilters: episode_nr>=50 AND episode_nr<100 AND episode_nr IS NOT NULL\n", children: [], attr: Some(Scan(ScanAttr { table_name: "title", attributes: [title.episode_nr, title.id, title.title] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: mk.movie_id, right_attr: t.id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.000421, cardinality: 2609129, extra_info: "movie_companies\n[INFOSEPARATOR]\nmovie_id\ncompany_id", children: [], attr: Some(Scan(ScanAttr { table_name: "movie_companies", attributes: [movie_companies.movie_id, movie_companies.company_id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: t.id, right_attr: mc.movie_id }, Equalizer { left_attr: mk.movie_id, right_attr: mc.movie_id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.001342, cardinality: 1, extra_info: "keyword\n[INFOSEPARATOR]\nkeyword\nid\n[INFOSEPARATOR]\nFilters: keyword=character-name-in-title AND keyword IS NOT NULL\n", children: [], attr: Some(Scan(ScanAttr { table_name: "keyword", attributes: [keyword.keyword, keyword.id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: mk.keyword_id, right_attr: k.id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.002228, cardinality: 84843, extra_info: "company_name\n[INFOSEPARATOR]\ncountry_code\nid\n[INFOSEPARATOR]\nFilters: country_code=[us] AND country_code IS NOT NULL\n", children: [], attr: Some(Scan(ScanAttr { table_name: "company_name", attributes: [company_name.country_code, company_name.id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: mc.company_id, right_attr: cn.id }] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: ci.movie_id, right_attr: t.id }, Equalizer { left_attr: ci.movie_id, right_attr: mk.movie_id }, Equalizer { left_attr: ci.movie_id, right_attr: mc.movie_id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.004586, cardinality: 901343, extra_info: "aka_name\n[INFOSEPARATOR]\nperson_id\nname", children: [], attr: Some(Scan(ScanAttr { table_name: "aka_name", attributes: [aka_name.person_id, aka_name.name] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: n.id, right_attr: an.person_id }, Equalizer { left_attr: ci.person_id, right_attr: an.person_id }] })) }
[(Name("ci"), [Name("person_id"), Name("movie_id")], []), (Name("n"), [Name("id")], []), (Node(TreeOp { name: "HASH_JOIN", timing: 0.001118, cardinality: 25, extra_info: "INNER\nmc.company_id = cn.id\n", children: [TreeOp { name: "HASH_JOIN", timing: 2.3e-5, cardinality: 54, extra_info: "INNER\nmk.keyword_id = k.id\n", children: [TreeOp { name: "HASH_JOIN", timing: 0.017806, cardinality: 4234, extra_info: "INNER\nt.id = mc.movie_id\nmk.movie_id = mc.movie_id\n", children: [TreeOp { name: "HASH_JOIN", timing: 0.016656, cardinality: 15655, extra_info: "INNER\nmk.movie_id = t.id\n", children: [TreeOp { name: "SEQ_SCAN", timing: 0.000855, cardinality: 4523930, extra_info: "movie_keyword\n[INFOSEPARATOR]\nmovie_id\nkeyword_id", children: [], attr: Some(Scan(ScanAttr { table_name: "movie_keyword", attributes: [movie_keyword.movie_id, movie_keyword.keyword_id] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.023682, cardinality: 68245, extra_info: "title\n[INFOSEPARATOR]\nepisode_nr\nid\ntitle\n[INFOSEPARATOR]\nFilters: episode_nr>=50 AND episode_nr<100 AND episode_nr IS NOT NULL\n", children: [], attr: Some(Scan(ScanAttr { table_name: "title", attributes: [title.episode_nr, title.id, title.title] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: mk.movie_id, right_attr: t.id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.000421, cardinality: 2609129, extra_info: "movie_companies\n[INFOSEPARATOR]\nmovie_id\ncompany_id", children: [], attr: Some(Scan(ScanAttr { table_name: "movie_companies", attributes: [movie_companies.movie_id, movie_companies.company_id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: t.id, right_attr: mc.movie_id }, Equalizer { left_attr: mk.movie_id, right_attr: mc.movie_id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.001342, cardinality: 1, extra_info: "keyword\n[INFOSEPARATOR]\nkeyword\nid\n[INFOSEPARATOR]\nFilters: keyword=character-name-in-title AND keyword IS NOT NULL\n", children: [], attr: Some(Scan(ScanAttr { table_name: "keyword", attributes: [keyword.keyword, keyword.id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: mk.keyword_id, right_attr: k.id }] })) }, TreeOp { name: "SEQ_SCAN", timing: 0.002228, cardinality: 84843, extra_info: "company_name\n[INFOSEPARATOR]\ncountry_code\nid\n[INFOSEPARATOR]\nFilters: country_code=[us] AND country_code IS NOT NULL\n", children: [], attr: Some(Scan(ScanAttr { table_name: "company_name", attributes: [company_name.country_code, company_name.id] })) }], attr: Some(Join(JoinAttr { join_type: Inner, equalizers: [Equalizer { left_attr: mc.company_id, right_attr: cn.id }] })) }), [Id(0)], [Id(1), Id(2), Id(3)]), (Name("an"), [Name("person_id")], [Name("name")])]
[Lookup([0 @ ci.person_id = 0 @ n.id), 1 @ ci.movie_id = 1 @ t.id), 0 @ ci.person_id = 2 @ an.person_id)])]
